<!DOCTYPE html>
<html>

<head>
  <title>‡∂∂‡∑Ñ‡∑î‡∑Ä‡∂ª‡∂´(MCQ)</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@100..900&display=swap" rel="stylesheet">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#162367">
  <style>
    body {
      font-family: "Noto Sans Sinhala", sans-serif;
      line-height: 1.6;
      margin: 5px;
      font-weight: 100;
      color: #ffffff;
      background: linear-gradient(0deg, #162367, #094741);
      background-repeat: no-repeat;
      background-size: cover;
      min-height: 100vh;
      font-size: 15px;
      max-width: 800px;
    margin: auto;
    }
    a{color: #FF9800;text-decoration: none;}
    #menu-toggle {
      position: fixed;
      top: 10px;
      left: 10px;
      z-index: 1001;
      background: #004d40;
      ;
      border: none;
      padding: 10px 12px;
      border-radius: 4px;
      font-size: 20px;
      cursor: pointer;
      color: #fff
    }

    .question-container {
      border-radius: 8px;
      margin-bottom: 20px;
      padding: 10px;
    }

    .question {
      margin-bottom: 10px;
    }

    .options ul {
      list-style-type: none;
      padding: 0;
    }

    .options li {
      min-width: 100px;
      margin-bottom: 5px;
      cursor: pointer;
      padding: 6px;
      box-shadow: 0 2px 3px #00000036;
      background-size: 200% 200%;
      transition: background-position 0.3s ease;
    }

    /* .options li:hover{background-position: 200% 0;}*/
    #explanation-popup {
      color: #ffffff;
      background: linear-gradient(0deg, #162367, #094741);
      opacity: 0;
      pointer-events: none;
      transition: opacity .5s ease;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 9999;
      margin: 0;
      padding-top: 10px;
      height: 100vh;
    }

    #explanation-popup.show {
      opacity: 1;
      pointer-events: auto;
    }



    #explanation-text {
      margin: 0 10px 30px;
      overflow-y: scroll;
      max-height: 70vh;
    }

    .divider {
      padding: 10px;
    }

    #explanation-quiz {
      margin: 40px 10px;
    }

    .explanation h4 {
      margin-top: 0;
    }

    #questions-container {
      max-width: 600px;
      margin: auto;
      padding-top: 100px;
    }

    .closebtn {
      position: fixed;
      right: 20px;
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      font-size: 25px;
      cursor: pointer
    }

    #prvnxt {
      margin: 20px auto;
      width: max-content;
      display: flex;
      gap: 30px;
    }

    #prev-btn,
    #next-btn {
      padding: 20px;
      border: none;
      box-shadow: 0 6px 11px #00000036;
      border-radius: 14px;
      cursor: pointer;
      color: #fff;
    }

    #prev-btn {
      background: transparent;
    }

    #next-btn {
      background: transparent;
    }

    mjx-container[jax="CHTML"][display="true"] {
      display: unset !important;
    }

    mjx-container {
      user-select: text !important;
      -webkit-user-select: text !important;
      -moz-user-select: text !important;
    }

    #topic-list {
      opacity: 0;
      position: fixed;
      top: 50px;
      left: 0;
      bottom: 0;
      width: 300px;
      background: #ffffff00;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
     /* transform: translateX(-100%);*/
      /* Hide by moving left */
      transition: transform 0.3s ease;
      z-index: 1000;
      overflow-y: auto;
      padding: 10px;
      pointer-events: none;
    }

    #topic-list.open {
     /* transform: translateX(0);
      /* Slide into view */
      opacity: 1;
      pointer-events:auto;
    }

    .topic-list li,
    .mcq-list li {
      padding: 10px 15px;
      background:linear-gradient(112deg, #009688, #009688, #43A047);
      margin: 5px 0;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .topic-list li ul li {
      background: #293c89;
    }

    .mcq-list li:hover,
    .mcq-list li.active {
      background: #195953;
    }

    #topic-list li>ul {
      margin-top: 0px;
      padding: 0;
    }

    #topic-list ul,.submenu {
      max-height: 0;
      overflow: scroll;
      transition: max-height 0.6s ease;
    }

    #topic-list li.open>ul {
      max-height: 500px;
    }
    #topic-list li.open .submenu{max-height: 50px;}
    #topic-list li {
      cursor: pointer;
      user-select: none;
    }

    #topic-list span {
      padding: 20px;
      font-size: 16px;
      font-weight: bold;
      color: #fff;
    }
    #topic-list li div{display: flex;}
    #topic-list li div img{width: 80px;}

    #topic-list > li {
  opacity: 0;
  transform: translateY(10px);
  transition: opacity .5s ease, transform .5s ease;
}
#topic-list.open > li {
  opacity: 1;
  transform: translateY(0);
}
#topic-list.open > li:nth-child(1) { transition-delay: 0.05s; }
#topic-list.open > li:nth-child(2) { transition-delay: 0.2s; }
#topic-list.open > li:nth-child(3) { transition-delay: 0.3s; }
#topic-list.open > li:nth-child(4) { transition-delay: 0.4s; }
#topic-list.open > li:nth-child(5) { transition-delay: 0.5s; }
/* Add more if needed */

/* Add more if needed */



    #explanation-text::-webkit-scrollbar {
      width: 4px;
    }



    #explanation-text::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 4px;
    }

    .longdivex {
      float: right;
      width: 80%;
      line-height: 13px;
      font-size: 10px;
    }

    .sadk {
      position: relative;
      margin-top: 25px;
      width: 140px;
      height: 50px;
    }

    .sadk .MathJax {
      position: absolute !important;
      right: 0;
      top: 15px;
    }

    .longdivex p {
      background: #1c5e7c;
      width: fit-content;
      padding: 5px;
      border-radius: 0 5px 5px;
      margin-bottom: 2px;
    }

    .graph-container {
      background: #fff;
    }

    .hidden {
      display: none;
    }

    .prime_divide>div {
      display: flex;
      line-height: 26px;
      align-items: center;
    }

    .prime_divide>div:not(:last-child)>span:nth-child(2) {
      padding: 2px 5px;
      border-left: 2px solid #fff;
      border-bottom: 2px solid #fff;
      display: inline-block;
      text-align: left;
    }

    .prime_divide>div>span:nth-child(2) {
      min-width: 30px;
    }

    .prime_divide>div>span:nth-child(3) {
      font-size: 10px;
      line-height: 13px;
    }
#explain-btn{
    padding: 20px;
    border: none;
    box-shadow: 0 6px 11px #00000036;
    border-radius: 14px;
    cursor: pointer;
    color: #fff;
    background: linear-gradient(112deg, #009688, #009688, #43A047);
    margin: auto;
    display: block;
}
.options .cc{background: red;}
#scores-panel{    padding-top: 100px;}
#topicChart{margin-top:0 !important}
  </style>


  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        packages: { '[+]': ['ams'] }
      },
      options: {
        enableMenu: false
      },
      chtml: {
        mtextInheritFont: true
      }
    }
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>
  <script src="js/graph.js"></script>
  <script src="js/line.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body>
  <button id="menu-toggle">
    ‚ò∞
  </button>



  <ul class="topic-list" id="topic-list">

  <!--  <li>
      <div><img src="img/on_your_mark.png" alt="On Your Mark" class="menu-icon">
        <span>‡∑É‡∑í‡∂Ø‡∑ä‡∂∞‡∑è‡∂±‡∑ä‡∂≠</span>
      </div>
    <ul id="tute-list">
        <li data-file="triangle.html" class="active">‡∂≠‡∑ä‚Äç‡∂ª‡∑í‡∂ö‡∑ù‡∂´ ‡∂¥‡∑ä‚Äç‡∂ª‡∂∏‡∑ö‡∂∫‡∂∫‡∂±‡∑ä</li>
        <li data-file="circle.html">‡∑Ä‡∑ò‡∂≠‡∑ä‡∂≠ ‡∂¥‡∑ä‚Äç‡∂ª‡∂∏‡∑ö‡∂∫‡∂∫‡∂±‡∑ä</li>
        <li data-file="log.html">‡∂Ω‡∂ù‡∑î‡∂ú‡∂´‡∂ö</li>
        <li data-file="trigonometry.html">‡∂Ω‡∂ù‡∑î‡∂ú‡∂´‡∂ö</li>
        <li data-file="triangle.html">‡∑Å‡∑ä‚Äç‡∂ª‡∑í‡∂≠/‡∂¥‡∑ä‚Äç‡∂ª‡∑É‡∑ä‡∂Æ‡∑è‡∂ª</li>
     </ul>
</li>-->
    <li>
      <div> <img src="img/get_set.png" alt="Get Set" class="menu-icon">
        <span>‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±/‡∂¥‡∑í‡∂Ω‡∑í‡∂≠‡∑î‡∂ª‡∑î</span>
      </div>
      <ul class="mcq-list" id="mcq-list">
        <li data-file="1.json" class="active">‡∂ë‡∂ö‡∂≠‡∑î ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∑ä ‡∑É‡∑Ñ ‡∂Ö‡∂©‡∑î ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∑ä</li>
        <li data-file="2.json">‡∂ú‡∑î‡∂´ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏</li>
        <li data-file="3.json">‡∂∂‡∑ô‡∂Ø‡∑ì‡∂∏</li>
        <li data-file="4.json">‡∂¥‡∑ä‚Äç‡∂ª‡∂Æ‡∂∏‡∂ö ‡∑É‡∑è‡∂∞‡∂ö ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</li>
        <li data-file="5.json">‡∑Ä‡∂ª‡∑ä‡∂ú‡∂∏‡∑ñ‡∂Ω ‡∂ë‡∂ö‡∂≠‡∑î ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∑Ñ‡∑è ‡∂Ö‡∂©‡∑î ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏</li>
        <li data-file="6.json">‡∑É‡∂∏‡∑ì‡∂ö‡∂ª‡∂´</li>
        <li data-file="7.json">‡∂Ö‡∑É‡∂∏‡∑è‡∂±‡∂≠‡∑è 1</li>
        <li data-file="8.json">‡∂Ö‡∑É‡∂∏‡∑è‡∂±‡∂≠‡∑è 2</li>
        <li data-file="9.json">‡∂Ö‡∑É‡∂∏‡∑è‡∂±‡∂≠‡∑è 3</li>
        <li data-file="10.json">‡∑É‡∂∏‡∂ú‡∑è‡∂∏‡∑ì ‡∑É‡∂∏‡∑ì‡∂ö‡∂ª‡∂´</li>
        <li data-file="11.json">‡∂∂‡∑Ñ‡∑î‡∂¥‡∂Ø ‡∂ú‡∑î‡∂´ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏</li>
        <li data-file="12.json">‡∂ö‡∑î‡∂©‡∑è‡∂∏ ‡∂¥‡∑ú‡∂Ø‡∑î ‡∂ú‡∑î‡∂´‡∑è‡∂ö‡∑è‡∂ª‡∂∫ ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</li>
        <li data-file="13.json">‡∂∑‡∑è‡∂ú ‡∂ë‡∂ö‡∂≠‡∑î ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∑Ñ‡∑è ‡∂Ö‡∂©‡∑î ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏</li>
        <li data-file="14.json">‡∂∑‡∑è‡∂ú ‡∂ú‡∑î‡∂´ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∑Ñ‡∑è ‡∂∂‡∑ô‡∂Ø‡∑ì‡∂∏</li>
        <li data-file="15.json">‡∂Ø‡∑ä‡∑Ä‡∑ì‡∂¥‡∂Ø ‡∂¥‡∑ä‚Äç‡∂ª‡∂ö‡∑è‡∑Å‡∂±‡∂∫‡∂ö ‡∑É‡∑è‡∂∞‡∂ö ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</li>
        <li data-file="16.json">‡∂∑‡∑è‡∂ú 1</li>
        <li data-file="17.json">‡∂∑‡∑è‡∂ú 2</li>
        <li data-file="18.json">‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∑Å‡∂≠ 1 (‡∑É‡∑î‡∂Ω‡∑î ‡∂¥‡∑ú‡∂Ω‡∑í‡∂∫)</li>
        <li data-file="19.json">‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∑Å‡∂≠ 2 (‡∑Ä‡∂ª‡∑í‡∂¥‡∂±‡∂∏‡∑ä ‡∂∂‡∂Ø‡∑î)</li>
        <li data-file="20.json">‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∑Å‡∂≠ 3 (‡∑Ä‡∑ê‡∂Ω‡∑ä ‡∂¥‡∑ú‡∂Ω‡∑ì)</li>
        <li data-file="21.json">‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∑Å‡∂≠ 4 (‡∑Ñ‡∑ì‡∂± ‡∑Ä‡∂± ‡∑Å‡∑ö‡∑Å ‡∂ö‡∑ä‚Äç‡∂ª‡∂∏‡∂∫)</li>
        <li data-file="22.json">‡∑Ä‡∑ì‡∂¢‡∑ì‡∂∫ ‡∂¥‡∂Ø‡∑Ä‡∂Ω ‡∂ö‡∑î‡∂©‡∑è‡∂∏ ‡∂¥‡∑ú‡∂Ø‡∑î ‡∂ú‡∑î‡∂´‡∑è‡∂ö‡∑è‡∂ª‡∂∫ ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</li>
        <li data-file="23.json">‡∂Ø‡∂ª‡∑ä‡∑Å‡∂ö ‡∑Ñ‡∑è ‡∂Ω‡∂ù‡∑î‡∂ú‡∂´‡∂ö</li>
        <li data-file="24.json">‡∑Ä‡∑ì‡∂¢‡∑ì‡∂∫ ‡∑É‡∂∏‡∑ì‡∂ö‡∂ª‡∂´ ‡∑Ä‡∑í‡∑É‡∂≥‡∑ì‡∂∏</li>
        <li data-file="25.json">‡∑É‡∑è‡∂∞‡∂ö‡∂∫‡∂ö‡∑ä ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</li>
        <li data-file="26.json">‡∂ú‡∑î‡∂´‡∑ù‡∂±‡∑ä‡∂≠‡∂ª ‡∑Å‡∑ä‚Äç‡∂ª‡∑ö‡∂™‡∑í</li>
        <li data-file="27.json">‡∑É‡∂∏‡∑ä‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è‡∑Ä</li>
        <li data-file="28.json">‡∑É‡∑í‡∂Ω‡∑í‡∂±‡∑ä‡∂©‡∂ª‡∂∫‡∂ö ‡∂¥‡∂ª‡∑í‡∂∏‡∑è‡∑Ä</li>
        <li data-file="29.json">‡∑É‡∂∏‡∑ì‡∂ö‡∂ª‡∂´</li>
        <li data-file="30.json">‡∂Ω‡∂ù‡∑î‡∂ú‡∂´‡∂ö</li>
        <li data-file="31.json">‡∂≠‡∑ä‚Äç‡∂ª‡∑í‡∂¥‡∂Ø ‡∑Ä‡∂ª‡∑ä‡∂ú‡∂¢ ‡∂¥‡∑ä‚Äç‡∂ª‡∂ö‡∑è‡∑Å‡∂±‡∂∫‡∂ö ‡∑É‡∑è‡∂∞‡∂ö ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</li>
        <li data-file="32.json">‡∑É‡∂∏‡∂ú‡∑è‡∂∏‡∑ì ‡∑É‡∂∏‡∑ì‡∂ö‡∂ª‡∂´ ‡∑Ä‡∑í‡∑É‡∂≥‡∑ì‡∂∏</li>
        <li data-file="33.json">‡∂õ‡∂±‡∑ä‡∂©‡∑è‡∂Ç‡∂ö ‡∑Ä‡∂Ω‡∑í‡∂±‡∑ä ‡∑É‡∂∏‡∑ì‡∂ö‡∂ª‡∂´‡∂∫ ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</li>
        <li data-file="34.json">‡∂Ö‡∂±‡∑ä‡∂≠‡∂É‡∂õ‡∂´‡∑ä‡∂©‡∂∫ ‡∑Ñ‡∑è ‡∂õ‡∂´‡∑ä‡∂©‡∑è‡∂Ç‡∂ö ‡∑Ä‡∂Ω‡∑í‡∂±‡∑ä ‡∂¥‡∑ä‚Äç‡∂ª‡∑É‡∑ä‡∂Æ‡∑è‡∂ª‡∂∫ ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</li>
        <li data-file="35.json">‡∂¥‡∑ä‚Äç‡∂ª‡∑É‡∑ä‡∂Æ‡∑è‡∂ª ‡∂∏‡∂ú‡∑í‡∂±‡∑ä ‡∂Ö‡∂±‡∑î‡∂ö‡∑ä‚Äç‡∂ª‡∂∏‡∂´‡∂∫ ‡∑Ñ‡∑è ‡∂Ö‡∂±‡∑ä‡∂≠‡∂É‡∂õ‡∂´‡∑ä‡∂©‡∂∫ ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</li>
        <li data-file="36.json">‡∂¥‡∑ä‚Äç‡∂ª‡∑É‡∑ä‡∂Æ‡∑è‡∂ª ‡∂∏‡∂ú‡∑í‡∂±‡∑ä ‡∑É‡∂∏‡∑ì‡∂ö‡∂ª‡∂´‡∂∫ ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</li>
        <li data-file="37.json">‡∂∏‡∑í‡∂±‡∑í‡∑É‡∑ä ‡∂Ø‡∑í‡∂± ‡∂ú‡∑ê‡∂ß‡∂Ω‡∑î</li>
        <li data-file="38.json">‡∂∏‡∂∞‡∑ä‚Äç‡∂∫‡∂±‡∑ä‚Äç‡∂∫‡∂∫(Mean)</li>
        <li data-file="39.json">‡∂∏‡∂∞‡∑ä‚Äç‡∂∫‡∑É‡∑ä‡∂Æ‡∂∫(Median)</li>
        <li data-file="40.json">‡∂∏‡∑è‡∂≠‡∂∫(mode)</li>
        <li data-file="41.json">‡∂ö‡∑ú‡∂ß‡∑É‡∑ä ‡∑Ñ‡∑è ‡∂Ω‡∑è‡∂∑‡∑è‡∂Ç‡∑Å</li>
      </ul>

    </li>
    <li class="live_test">
      <div> <img src="img/go.png" alt="Go" class="menu-icon">
        <span>‡∑Ä‡∑í‡∂∑‡∑è‡∂ú</span>
      </div>
    </li>

    <li id="scores">
      <div><img src="img/victory.png" alt="Victory" class="menu-icon">
        <span>‡∂¥‡∑ä‚Äç‡∂ª‡∂ú‡∂≠‡∑í ‡∑Ä‡∑è‡∂ª‡∑ä‡∂≠‡∑è‡∑Ä</span>
      </div>
    </li>

  </ul>
  <h1></h1>
  <p></p>


<div id="tutes-panel">
  <div id="questions-container">
  </div>
  <div id="prvnxt">
    <button id="prev-btn">‡∂¥‡∑ô‡∂ª ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±‡∂∫</button>
    <button id="next-btn">‡∂ä‡∑Ö‡∂ü ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±‡∂∫</button>

  </div>
  <button id="explain-btn">‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂¥‡∑í‡∂Ω‡∑í‡∂≠‡∑î‡∂ª</button>
</div>
<div id="scores-panel" style="display:none;">
  <p id="examscorehead">‡∑Ä‡∑í‡∂∑‡∑è‡∂ú ‡∂Ω‡∂ö‡∑î‡∂´‡∑î ‡∂Ö‡∂±‡∑î‡∑Ä ‡∂¥‡∑ä‚Äç‡∂ª‡∂ú‡∂≠‡∑í‡∂∫<br>(‡∑Ä‡∑í‡∂∑‡∑è‡∂ú ‡∑É‡∂≥‡∑Ñ‡∑è <a href="#" class="live_test">‡∂∏‡∑ô‡∂≠‡∂±‡∑í‡∂±‡∑ä</a> ‡∂¥‡∑í‡∑Ä‡∑í‡∑É‡∑ô‡∂±‡∑ä‡∂±)</p>
    <canvas id="examScoreChart"></canvas>
    <br><br>
    <div>‡∑Ä‡∑í‡∂∑‡∑è‡∂ú ‡∂Ω‡∂ö‡∑î‡∂´‡∑î ‡∂Ö‡∂±‡∑î‡∑Ä ‡∂ë‡∂ö‡∑ä ‡∂ë‡∂ö‡∑ä ‡∂¥‡∑è‡∂©‡∂∏‡∑ä ‡∑Ä‡∂Ω ‡∂¥‡∑ä‚Äç‡∂ª‡∂ú‡∂≠‡∑í‡∂∫. <br> ‡∂Ø‡∑í‡∂ú‡∂∏ ‡∂≠‡∑ì‡∂ª‡∑î‡∑Ä ‡∑Ñ‡∑í‡∂∏‡∑í ‡∂¥‡∑è‡∂©‡∂∏‡∂ß ‡∑Ä‡∑ê‡∂©‡∑í‡∂∏ ‡∂Ω‡∂ö‡∑î‡∂´‡∑î ‡∂Ω‡∑ê‡∂∂‡∑ì ‡∂á‡∂≠</div>
    <div id="topicChartWrapper" style="height:1000px; overflow-y:auto;">
    <canvas id="topicChart" style="margin-top:40px;"></canvas>
  </div>
  </div>

  <!-- Explanation popup -->
  <div id="explanation-popup">
    <button onclick="closePopup()" class="closebtn">&times;</button>
    <p id="explanation-quiz"></p>
    <p id="explanation-text"></p>

  </div>
  <div class="number-line-target">
  </div>
  <script>

    let skd = '<div style="position: absolute;width: 62px;height: 42px;transform: rotate(329deg);top: -10px;left: 36px;border: 2px solid #d2d2d2;border-radius: 50%;box-sizing: border-box;border-color: #d8d8d8 #d6d6d6 transparent transparent;"></div>' +
      '<div style="position: absolute;width: 98px;height: 71px;transform: rotate(329deg);top: -23px;left: 34px;border: 2px solid black;border-radius: 50%;box-sizing: border-box;border-color: #eaeaea #ffffff transparent transparent"></div>' +
      '<div style="position: absolute;width: 20px;height: 23px;transform: rotate(317deg);top: 35px;left: 67px;border: 2px solid black;border-radius: 50%;box-sizing: border-box;border-color: transparent transparent #ffffff #ffffff"></div>' +
      '<div style="position: absolute;width: 52px;height: 56px;transform: rotate(317deg);top: 17px;left: 67px;border: 2px solid black;border-radius: 50%;box-sizing: border-box;border-color: transparent transparent #ffffff #ffffff"></div>' +
      '<div style="position: absolute;top: -4px;left: 85px;width: 20px;height: 20px;background: #fafafa;color: #000000;text-align: center;line-height: 14px;font-size: 12px;transform: rotate(361deg);clip-path: polygon(50% 100%, 0 0, 100% 0)">1</div>' +
      '<div style="position: absolute;top: -4px;left: 116px;width: 20px;height: 20px;background: #fafafa;color: #000000;text-align: center;line-height: 14px;font-size: 12px;transform: rotate(361deg);clip-path: polygon(50% 100%, 0 0, 100% 0)">2</div>' +
      '<div style="position: absolute;top: 34px;left: 77px;width: 20px;height: 20px;background: #fafafa;color: #000000;text-align: center;line-height: 24px;font-size: 12px;transform: rotate(28deg);clip-path: polygon(50% 0%, 0 100%, 100% 100%)">3</div>' +
      '<div style="position: absolute;top: 36px;left: 109px;width: 20px;height: 20px;background: #fafafa;color: #000000;text-align: center;line-height: 24px;font-size: 12px;transform: rotate(10deg);clip-path: polygon(50% 0%, 0 100%, 100% 100%)">4</div>';
      function getTopicList() {
    var topic_list = {};
    var listItems = document.querySelectorAll('#mcq-list li');

    listItems.forEach(function(li) {
        // Extract the number from "1.json", "2.json", etc.
        var fileName = li.getAttribute('data-file');
        var fileNumber = fileName.replace('.json', '');
        
        // Map the number to the Sinhala text
        topic_list[fileNumber] = li.textContent.trim();
    });

    return topic_list;
}

var topic_list = getTopicList();

/* =========================
   GLOBALS
========================= */
//let skd = '';
var catid = '';
const popup = document.getElementById('explanation-popup');

let allQuestions = [];
let currentQuestionIndex = 0;
let selectedAnswerIndex = null;
let stats = {};
let currentTopic = null;
let currentFileNumber = 0;
let isExam = false;

/* =========================
   COOKIE HELPERS
========================= */
function setCookie(name, value, days = 365) {
  const expires = new Date(Date.now() + days * 24 * 60 * 60 * 1000).toUTCString();
  document.cookie = `${name}=${encodeURIComponent(JSON.stringify(value))}; expires=${expires}; path=/`;
}

function getCookie(name) {
  const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
  return match ? JSON.parse(decodeURIComponent(match[2])) : null;
}

/* =========================
   EXAM ANALYTICS (LAST 5)
========================= */
let examStats = getCookie("examStats") || {
  scores: [],
  topics: {}
};

let currentExamTopicResults = {};
let currentExamScore = 0;

/* =========================
   NORMAL QUIZ LOAD
========================= */
async function loadQuestions(jsonFilePath) {
  catid = jsonFilePath;
  isExam = false;
 

  try {
    const response = await fetch(jsonFilePath);

    // Check if the network request actually succeeded
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    allQuestions = await response.json();
    allQuestions.forEach(item => {
    item.catID = +jsonFilePath.split('.')[0];
   });
    // Ensure we actually got an array back
    if (!Array.isArray(allQuestions)) {
      throw new Error("JSON data is not an array");
    }

    shuffleArray(allQuestions);
    currentQuestionIndex = 0;
    showQuestion(allQuestions[currentQuestionIndex]);
    updateStatsDisplay();

  } catch (error) {
    console.error("Detailed Error:", error); // This helps you debug in the F12 console
    document.getElementById('questions-container').innerHTML =
      `<p style="color:red;">Error loading questions: ${error.message}</p>
       <button onclick="loadQuestions('${jsonFilePath}')">Retry</button>`;
  }
}

/* =========================
   SHUFFLE
========================= */
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

/* =========================
   SHOW QUESTION
========================= */
function showQuestion(question) {
  document.getElementById('scores-panel').style.display = 'none';
  document.getElementById('tutes-panel').style.display = 'block';
  const container = document.getElementById('questions-container');
console.log(question)
  let optionsHtml = '';
  let x = 0;
  question.options.forEach((option, index) => {
    x++;
    if(index==question.answerIndex){
      cc='cc'
    }else{cc=''
  }
    optionsHtml += `<li data-index="${index}" class="${cc}">${x}) ${option}</li>`;
  });

  let html = `
    <div class="question-container">
      <div class="question">${question.question}</div>
  `;

  if (isExam) { 
    html += `
      <div class="options">
        <ul>${optionsHtml}</ul>
      </div>`;
    document.getElementById('explain-btn').style.display = 'none';
  } else {
    document.getElementById('explain-btn').style.display = 'block';
  }

  html += `</div>`;
  container.innerHTML = html;

  selectedAnswerIndex = null;

  /* graph logic preserved */
  if (question.catID == '35' || question.catID == '36') {
    const parentElement = document.querySelector('.question');
    const newContainer = document.createElement('div');
    newContainer.className = 'graph-container';
    parentElement.appendChild(newContainer);
    createGraphSVG('.graph-container');
    updateGraph(document.querySelector('.question .hidden')?.innerHTML, true);
  }

  const optionElements = container.querySelectorAll('.options li');
  optionElements.forEach(li => {
    li.addEventListener('click', () => {
      optionElements.forEach(o => o.classList.remove('selected'));
      li.classList.add('selected');
      selectedAnswerIndex = parseInt(li.dataset.index, 10);
      //console.log(question)
      checkAnswer(question);
      
    });
  });

  document.getElementById('explain-btn').onclick = () => {
    showExplanation(question.explanation, question.question);
  };

  if (window.MathJax) {
    MathJax.typesetClear();
    MathJax.typesetPromise([container]);
  }
}



/* =========================
   NAVIGATION
========================= */
function showNextQuestion() {
  if (currentQuestionIndex < allQuestions.length - 1) {
    currentQuestionIndex++;
    showQuestion(allQuestions[currentQuestionIndex]);
  } else {
    if (isExam) finishExam();
    else {
      shuffleArray(allQuestions);
      currentQuestionIndex = 0;
      showQuestion(allQuestions[currentQuestionIndex]);
    }
  }
}

function showPreviousQuestion() {
  if (currentQuestionIndex > 0) {
    currentQuestionIndex--;
    showQuestion(allQuestions[currentQuestionIndex]);
  }
}

/* =========================
   EXPLANATION POPUP
========================= */
function showExplanation(explanation, quiz) {
  document.getElementById('explanation-quiz').innerHTML = quiz;
  document.getElementById('explanation-text').innerHTML =
    '<h4>‡∑Ä‡∑í‡∑É‡∂≥‡∑î‡∂∏:</h4>' + explanation.replace(/<br\s*\/?>/gi, '<div class="divider"></div>');

  popup.classList.add('show');

  if (window.MathJax) {
    MathJax.typesetClear([popup]);
    MathJax.typesetPromise([popup]);
  }

  if (catid == '11.json') {
    document.querySelectorAll('#explanation-text .sadk').forEach(el => {
      el.insertAdjacentHTML('beforeend', skd);
    });
  }

  if (catid == '1.json') {
    const parentElement = document.getElementById('explanation-text');
    const newContainer = document.createElement('div');
    newContainer.className = 'line-container';
    parentElement.appendChild(newContainer);
    visualizeOperation(quiz.replace(/\$\$/g, "").trim(), "line-container");
  }
}

/* =========================
   STATS DISPLAY
========================= */
function updateStatsDisplay() {
  const statsBox = document.getElementById('stats-box');
  if (!statsBox) return;
  const s = stats[currentTopic] || { correct: 0, wrong: 0 };
  statsBox.innerHTML = `‚úÖ Correct: ${s.correct} | ‚ùå Wrong: ${s.wrong}`;
}

/* =========================
   LIVE EXAM LOAD
========================= */
async function loadLiveExamQuestions() {
  isExam = true;
  currentExamTopicResults = {};
  currentExamScore = 0;

  const promises = [];

  Object.keys(topic_list).forEach(topicId => {
    const file = `${topicId}.json`;

    promises.push(
      fetch(file)
        .then(r => r.ok ? r.json() : [])
        .then(arr => {
          if (!Array.isArray(arr) || arr.length === 0) return null;

          const q = arr[Math.floor(Math.random() * arr.length)];
          q._topic = topicId.toString(); 
          q.catID=+topicId;
          return q;
        })
        .catch(err => {
          console.warn(`Failed to load ${file}`, err);
          return null;
        })
    );
  });

  const results = await Promise.all(promises);
  allQuestions = results.filter(Boolean);

  if (!allQuestions.length) {
    document.getElementById('questions-container').innerHTML =
      '<p style="color:red;">No exam questions available</p>';
    return;
  }

  shuffleArray(allQuestions);
  currentQuestionIndex = 0;

  showQuestion(allQuestions[0]);
}


/* =========================
   ANSWER CHECK
========================= */
function checkAnswer(question) {
  if (selectedAnswerIndex === null) return;
  const correct = selectedAnswerIndex === question.answerIndex;
  if (isExam && question._topic) {
    currentExamTopicResults[question._topic] = correct ? 1 : 0;
  }

}

/* =========================
   FINISH EXAM
========================= */
function finishExam() {
  let score = 0;

  // calculate score from topic results
  Object.values(currentExamTopicResults).forEach(val => {
    if (val === 1) score++;
  });

  // save score
  examStats.scores.push(score);
  if (examStats.scores.length > 10) {
    examStats.scores.shift();
  }

  // save topic-wise results
  Object.entries(currentExamTopicResults).forEach(([topic, val]) => {
    if (!examStats.topics[topic]) {
      examStats.topics[topic] = [];
    }

    examStats.topics[topic].push(val);

    if (examStats.topics[topic].length > 10) {
      examStats.topics[topic].shift();
    }
  });

  setCookie("examStats", examStats);
  showFinalScorePopup(score);
}


/* =========================
   FINAL SCORE POPUP
========================= */
function showFinalScorePopup() {
  const total = Object.keys(currentExamTopicResults).length;
  const percent = ((currentExamScore / total) * 100).toFixed(1);

  let weak = '';
  Object.entries(currentExamTopicResults).forEach(([t, v]) => {
    if (v === 0) weak += `<li>Topic ${t}</li>`;
  });

  document.getElementById('explanation-quiz').innerHTML = "üìä Exam Result";
  document.getElementById('explanation-text').innerHTML = `
    <p><b>Score:</b> ${currentExamScore} / ${total}</p>
    <p><b>Success:</b> ${percent}%</p>
    <h4>Weak Topics</h4>
    <ul>${weak || '<li>None üéâ</li>'}</ul>
    <button class="start-exam-btn" onclick="closePopup()">Close</button>
  `;
  popup.classList.add('show');
}

/* =========================
   LIVE EXAM CONFIRM POPUP
========================= */
function showLiveExamPopup() {
 // document.getElementById('explanation-quiz').innerHTML = "üìù Live Exam";
  document.getElementById('explanation-text').innerHTML = `
  <div style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; border: 2px solid #4A90E2; border-radius: 10px; padding: 20px; max-width: 400px; ">
    <ul style="list-style-type: none; padding: 0; line-height: 1.8;">
        <li>üìù ‡∂∏‡∑ô‡∂∫ ‡∂ö‡∑ô‡∂ß‡∑í ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂± 40‡∂ö ‡∑Ä‡∑í‡∂∑‡∑è‡∂ú‡∂∫‡∂ö‡∑í</li>  
        <li>‚úÖ ‡∂Ω‡∂∂‡∑è ‡∂Ø‡∑ì ‡∂á‡∂≠‡∑í ‡∑Ä‡∑í‡∂ö‡∂Ω‡∑ä‡∂¥ 4‡∂±‡∑ä ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂¥‡∑í‡∂Ω‡∑í‡∂≠‡∑î‡∂ª ‡∂≠‡∑ù‡∂ª‡∂±‡∑ä‡∂±</li>
        <li>‚è±Ô∏è ‡∂ö‡∑è‡∂Ω‡∂∫ ‡∂ö‡∑Ö‡∂∏‡∂±‡∑è‡∂ö‡∂ª‡∂´‡∂∫ ‡∂ú‡∑ê‡∂± ‡∑É‡∑ê‡∂Ω‡∂ö‡∑í‡∂Ω‡∑í‡∂∏‡∂≠‡∑ä ‡∑Ä‡∂±‡∑ä‡∂±</li>
        <li>üß† ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂± ‡∑É‡∑í‡∂∫‡∂Ω‡∑ä‡∂Ω ‡∑Ñ‡∑ú‡∂≥‡∑í‡∂±‡∑ä ‡∂ö‡∑í‡∂∫‡∑Ä‡∑è ‡∂Ö‡∑Ä‡∂∂‡∑ù‡∂∞ ‡∂ö‡∂ª‡∂ú‡∂±‡∑ä‡∂±</li>
    </ul>
    <div style="margin-top: 20px; text-align: center; font-weight: bold; ">
        ‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∑Ä ‡∑Ä‡∑í‡∂∑‡∑è‡∂ú‡∂∫‡∂ß ‡∂∏‡∑î‡∑Ñ‡∑î‡∂´ ‡∂Ø‡∑ì‡∂∏‡∂ß ‡∑É‡∑î‡∂∑ ‡∂¥‡∂≠‡∂∏‡∑î!
    </div>
    <button class="start-exam-btn" onclick="closePopup();loadLiveExamQuestions()" 
    style="background: linear-gradient(112deg, #009688, #009688, #43A047);
    padding: 10px;
    border: none;
    border-radius: 5px;
    color: #fff;cursor:pointer"
>‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</button>
</div>
  `;
  popup.classList.add('show');
}

/* =========================
   MENU / UI (UNCHANGED)
========================= */
function closePopup() {
  popup.classList.remove('show');
}

document.getElementById('menu-toggle').addEventListener('click', () => {
  document.getElementById('topic-list').classList.toggle('open');
});

const menuToggle = document.getElementById('menu-toggle');
const topicList = document.getElementById('topic-list');

document.addEventListener('click', (e) => {
  if (menuToggle.contains(e.target)) return;
  if (topicList.contains(e.target)) return;
  topicList.classList.remove('open');
});

topicList.addEventListener('click', (e) => {
  if (e.target.closest('#topic-list ul ul li') || e.target.closest('#mcq-list li')) {
    topicList.classList.remove('open');
  }
  if (!e.target.closest('#topic-list li')?.querySelector(':scope > ul')) {
    topicList.classList.remove('open');
  }
});

document.getElementById('mcq-list').addEventListener('click', (e) => {
  if (e.target.tagName === 'LI') {
    document.getElementById('mcq-list').classList.remove('open');
    popup.classList.remove('show');
  }
});

document.addEventListener("DOMContentLoaded", () => {
  const firstTopic = document.querySelector('#mcq-list li[data-file]');
  if (firstTopic) loadQuestions(firstTopic.dataset.file);

  var topicList = document.getElementById('mcq-list');

topicList.addEventListener('click', event => {
  const li = event.target.closest('li');

  if (!li || li.parentElement !== topicList) return;

  topicList.querySelectorAll('li').forEach(item => {
    item.classList.remove('active');
  });

  li.classList.add('active');

  const file = li.dataset.file;
  loadQuestions(file);
});

  document.getElementById('next-btn').onclick = showNextQuestion;
  document.getElementById('prev-btn').onclick = showPreviousQuestion;
  document.addEventListener('click', e => {
  const el = e.target.closest('.live_test');
  if (!el) return;
  e.preventDefault();  
  showLiveExamPopup();
});

});
document.addEventListener("DOMContentLoaded", () => {
      const parentItems = document.querySelectorAll("#topic-list > li");

      parentItems.forEach(li => {
        const childUl = li.querySelector(":scope > ul");
        if (!childUl) return; 
        li.addEventListener("click", (e) => {
          if (e.target.closest("ul") !== li.querySelector(":scope > ul")) {
            e.stopPropagation();
            li.classList.toggle("open");
          }
        });
      });
    });
    document.getElementById("scores").addEventListener("click", () => {
  renderScoreCharts();
});
let examChart = null;
let topicChart = null;

function renderScoreCharts() {
  document.getElementById('scores-panel').style.display = 'block';
  document.getElementById('tutes-panel').style.display = 'none';  
  const examStats = getCookie("examStats");

  if (!examStats) return;

  renderExamLineChart(examStats.scores);
  renderTopicBarChart(examStats.topics);
}
function renderExamLineChart(scores) {
  const ctx = document.getElementById("examScoreChart").getContext("2d");
 // console.log(scores.length)
//"examscorehead"
  if (examChart) examChart.destroy();

  examChart = new Chart(ctx, {
    type: "line",
    data: {
      labels: scores.map((_, i) => `Exam ${i + 1}`),
      datasets: [{
       // label: "Exam Score",
        data: scores,
        borderWidth: 2,
        tension: 0.3,
      //  fill: false
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: {
          beginAtZero: true,
          min: 0,
          max: 42,             
    
        }
      },plugins: {
      legend: {
        display: false
      }
    }
    }
  });
}
function renderTopicBarChart(topics) {
  const canvas = document.getElementById("topicChart");
  const ctx = canvas.getContext("2d");
  const wrapper = document.getElementById("topicChartWrapper");

  if (topicChart) topicChart.destroy();

  const labels = [];
  const values = [];

  Object.entries(topics).forEach(([topic, results]) => {
    if(topic_list[topic]){
    const topicName = topic_list[topic];
    labels.push(wrapLabel(topicName, 25));
    values.push(results.reduce((a, b) => a + b, 0));
    }
  });

  // ‚úÖ increase vertical space
  const minHeightPerBar = 35;
  wrapper.style.height = `${values.length * minHeightPerBar}px`;

  topicChart = new Chart(ctx, {
    type: "bar",
    data: {
      labels,
      datasets: [{
        data: values,
        barThickness: 30,
        categoryPercentage: 0.5,
        barPercentage: 0.9
      }]
    },
    options: {
      indexAxis: 'y',
      responsive: true,
      maintainAspectRatio: false,
      //type: 'linear',    
      scales: {
  x: {
    beginAtZero: true,
    min: 0,
    max: 10,          // üëà force full range
    ticks: {
      autoSkip: false // show all labels
    }
  },
  y: {
    ticks: { autoSkip: false }
  }
}
,
      plugins: {
        legend: { display: false }
      }
    }
  });
}

function wrapLabel(text, maxLength = 30) {
  if (text.length <= maxLength) return text;

  const words = text.split(" ");
  let line1 = "";
  let line2 = "";

  for (const word of words) {
    if ((line1 + word).length <= maxLength) {
      line1 += (line1 ? " " : "") + word;
    } else {
      line2 += (line2 ? " " : "") + word;
    }
  }

  return [line1, line2];
}



  </script>


</body>

</html>